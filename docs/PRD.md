# 노션 견적서 웹 뷰어 시스템 PRD

## 문서 정보

| 항목 | 내용 |
|------|------|
| 문서 버전 | 1.0.0 |
| 최종 수정일 | 2026-01-17 |
| 문서 상태 | 초안 (Draft) |
| 작성자 | Product Team |

---

## 1. 개요 (Overview)

### 1.1 프로젝트 명
**노션 견적서 웹 뷰어 시스템** (Notion Quote Web Viewer)

### 1.2 프로젝트 요약
노션(Notion)에서 작성된 견적서 데이터를 노션 API를 통해 연동하여, 클라이언트가 웹 브라우저에서 견적서를 확인하고 PDF로 다운로드할 수 있는 시스템을 구축합니다.

### 1.3 핵심 가치 제안
- **효율성**: 노션에서 견적서를 관리하면서 클라이언트에게는 전문적인 웹 인터페이스 제공
- **접근성**: 클라이언트가 언제 어디서나 견적서를 확인 가능
- **전문성**: 일관된 디자인의 PDF 견적서 제공으로 브랜드 이미지 강화

---

## 2. 배경 및 목적 (Background & Objectives)

### 2.1 현재 상황 및 문제점

| 문제 | 설명 | 영향 |
|------|------|------|
| 견적서 공유 비효율 | 노션 링크 공유 시 편집 권한 관리 어려움 | 보안 리스크, 고객 경험 저하 |
| PDF 생성 수작업 | 매번 수동으로 PDF 변환 및 전송 필요 | 업무 시간 증가, 휴먼 에러 가능성 |
| 브랜딩 불일치 | 노션 기본 스타일로 인한 브랜드 일관성 부족 | 전문성 인식 저하 |
| 이력 관리 부재 | 클라이언트의 견적서 열람 여부 확인 불가 | 영업 활동 효율성 저하 |

### 2.2 해결하고자 하는 핵심 문제
1. 노션 데이터를 자동으로 웹 페이지에 표시하여 수작업 최소화
2. 클라이언트 전용 뷰어 페이지를 통한 보안 강화
3. 브랜드 아이덴티티가 반영된 전문적인 견적서 제공
4. 원클릭 PDF 다운로드로 고객 편의성 향상

### 2.3 비즈니스 목표

| 목표 | 지표 | 목표치 |
|------|------|--------|
| 견적서 생성 시간 단축 | 견적서 1건당 처리 시간 | 기존 대비 70% 감소 |
| 고객 만족도 향상 | 견적서 관련 문의 건수 | 기존 대비 50% 감소 |
| 전환율 개선 | 견적서 발송 후 계약 전환율 | 기존 대비 15% 향상 |

---

## 3. 목표 사용자 (Target Users)

### 3.1 사용자 페르소나

#### 페르소나 1: 내부 관리자 (Admin)
| 항목 | 내용 |
|------|------|
| 역할 | 견적서 작성 및 관리 담당자 |
| 목표 | 노션에서 견적서를 효율적으로 작성하고 클라이언트에게 공유 |
| 니즈 | 간편한 링크 생성, 열람 현황 확인 |
| 기술 수준 | 노션 사용에 익숙함 |

#### 페르소나 2: 클라이언트 (Client)
| 항목 | 내용 |
|------|------|
| 역할 | 견적서를 받아보는 고객 |
| 목표 | 견적서 내용 확인 및 PDF 보관 |
| 니즈 | 빠른 로딩, 명확한 정보 표시, 쉬운 PDF 다운로드 |
| 기술 수준 | 일반 웹 사용자 수준 |

### 3.2 사용자 플로우 다이어그램

```
[관리자 플로우]
노션에서 견적서 작성 → 데이터베이스에 저장 → 고유 URL 생성 → 클라이언트에게 URL 전달

[클라이언트 플로우]
URL 접속 → 견적서 웹 페이지 확인 → (선택) PDF 다운로드 → 완료
```

### 3.3 페이지 흐름도

```
┌─────────────────────────────────────────────────────────────────┐
│                        클라이언트 접근 흐름                        │
└─────────────────────────────────────────────────────────────────┘

                    [고유 URL 접속]
                          │
                          ▼
                ┌─────────────────┐
                │   URL 유효성    │
                │     검증        │
                └────────┬────────┘
                         │
           ┌─────────────┴─────────────┐
           │                           │
           ▼                           ▼
    [유효한 경우]               [유효하지 않은 경우]
           │                           │
           ▼                           ▼
┌─────────────────┐          ┌─────────────────┐
│  견적서 상세    │          │   404 에러      │
│  페이지 (QT-01) │          │   페이지        │
└────────┬────────┘          └─────────────────┘
         │
         ├─────────────────┐
         │                 │
         ▼                 ▼
┌─────────────────┐ ┌─────────────────┐
│  PDF 다운로드   │ │  인쇄 기능      │
│  (QT-02)        │ │  (QT-03)        │
└─────────────────┘ └─────────────────┘
```

---

## 4. 범위 (Scope)

### 4.1 포함 범위 (In Scope)

| 카테고리 | 항목 |
|----------|------|
| 노션 연동 | 노션 API를 통한 견적서 데이터 조회 |
| 웹 뷰어 | 견적서 상세 페이지 표시 |
| PDF 기능 | 견적서 PDF 생성 및 다운로드 |
| UI/UX | 반응형 디자인, 다크모드 지원 |
| 보안 | 고유 URL 기반 접근 제어 |

### 4.2 제외 범위 (Out of Scope)

| 항목 | 사유 |
|------|------|
| 노션 데이터 수정 기능 | 보안 및 데이터 무결성 보장을 위해 읽기 전용으로 제한 |
| 사용자 인증 시스템 | MVP 단계에서는 URL 기반 접근으로 충분 |
| 견적서 생성/편집 UI | 노션 자체 기능 활용 |
| 결제 연동 | 향후 버전에서 고려 |
| 다국어 지원 | 1차 출시는 한국어만 지원 |

### 4.3 향후 고려사항 (Future Considerations)

| 버전 | 기능 |
|------|------|
| v1.1 | 관리자 대시보드 (열람 현황, 통계) |
| v1.2 | 이메일 알림 기능 (견적서 열람 시 알림) |
| v2.0 | 온라인 결제 연동 |
| v2.1 | 다국어 지원 (영어, 일본어) |

---

## 5. 기능 요구사항 (Functional Requirements)

### 5.1 기능 명세 총괄표

| 기능 ID | 기능명 | 우선순위 | 관련 페이지 |
|---------|--------|----------|-------------|
| QT-01 | 견적서 상세 조회 | P0 | 견적서 상세 페이지 |
| QT-02 | PDF 다운로드 | P0 | 견적서 상세 페이지 |
| QT-03 | 인쇄 기능 | P1 | 견적서 상세 페이지 |
| NT-01 | 노션 데이터 동기화 | P0 | (백엔드) |
| NT-02 | 실시간 데이터 갱신 | P2 | 견적서 상세 페이지 |
| UI-01 | 반응형 레이아웃 | P0 | 전체 |
| UI-02 | 다크모드 지원 | P1 | 전체 |
| UI-03 | 로딩 상태 표시 | P0 | 전체 |
| ER-01 | 에러 페이지 | P0 | 404/500 에러 페이지 |

### 5.2 핵심 기능 상세

---

#### QT-01: 견적서 상세 조회

| 항목 | 내용 |
|------|------|
| 기능 ID | QT-01 |
| 기능명 | 견적서 상세 조회 |
| 우선순위 | P0 (Must Have) |

**사용자 스토리**
> As a 클라이언트,
> I want 웹 페이지에서 견적서 내용을 확인하고 싶다,
> so that 별도 프로그램 설치 없이 어디서나 견적서를 볼 수 있다.

**상세 설명**
- 고유 URL을 통해 특정 견적서에 접근
- 노션 데이터베이스에서 해당 견적서 정보를 조회하여 표시
- 견적서의 모든 항목(업체 정보, 품목, 금액 등)을 구조화하여 표시

**인수 조건 (Acceptance Criteria)**
- [ ] 유효한 견적서 ID로 접근 시 3초 이내에 페이지 로딩 완료
- [ ] 견적서 기본 정보(견적 번호, 발행일, 유효기간) 표시
- [ ] 발신자 정보(회사명, 담당자, 연락처) 표시
- [ ] 수신자 정보(회사명, 담당자) 표시
- [ ] 품목 리스트(품명, 수량, 단가, 금액) 테이블 형태로 표시
- [ ] 합계 금액(소계, 부가세, 총액) 명확히 표시
- [ ] 비고/특이사항 표시
- [ ] 모바일/태블릿/데스크톱 반응형 지원

**입력/출력 정의**

| 구분 | 항목 | 타입 | 필수 | 설명 |
|------|------|------|------|------|
| Input | quoteId | string | Y | 견적서 고유 식별자 (URL 파라미터) |
| Output | quote | QuoteData | Y | 견적서 전체 데이터 객체 |

**비즈니스 로직**
1. URL에서 quoteId 추출
2. 노션 API를 통해 해당 ID의 견적서 데이터 조회
3. 데이터 유효성 검증 (존재 여부, 만료 여부)
4. 화면에 데이터 렌더링

**예외 처리**

| 예외 상황 | 처리 방법 |
|----------|----------|
| 존재하지 않는 견적서 ID | 404 에러 페이지 표시 |
| 노션 API 오류 | 500 에러 페이지 + 재시도 버튼 |
| 견적서 유효기간 만료 | 만료 안내 메시지 표시 (내용은 확인 가능) |

---

#### QT-02: PDF 다운로드

| 항목 | 내용 |
|------|------|
| 기능 ID | QT-02 |
| 기능명 | PDF 다운로드 |
| 우선순위 | P0 (Must Have) |

**사용자 스토리**
> As a 클라이언트,
> I want 견적서를 PDF 파일로 다운로드하고 싶다,
> so that 오프라인에서도 견적서를 확인하고 보관할 수 있다.

**상세 설명**
- 견적서 페이지에서 PDF 다운로드 버튼 클릭 시 PDF 파일 생성 및 다운로드
- 웹 페이지와 동일한 내용을 A4 규격에 맞게 포맷팅
- 회사 로고 및 브랜딩 요소 포함

**인수 조건 (Acceptance Criteria)**
- [ ] PDF 다운로드 버튼 클릭 시 5초 이내 다운로드 시작
- [ ] PDF 파일명: `견적서_[견적번호]_[발행일].pdf` 형식
- [ ] A4 규격 (210mm x 297mm) 준수
- [ ] 한글 폰트 정상 표시 (Noto Sans KR)
- [ ] 회사 로고 포함
- [ ] 품목 테이블이 페이지를 넘어갈 경우 자동 페이지 분할
- [ ] 각 페이지에 페이지 번호 표시

**입력/출력 정의**

| 구분 | 항목 | 타입 | 필수 | 설명 |
|------|------|------|------|------|
| Input | quoteId | string | Y | 견적서 고유 식별자 |
| Output | pdfFile | Blob | Y | 생성된 PDF 파일 |

**비즈니스 로직**
1. 현재 페이지의 견적서 데이터 수집
2. PDF 템플릿에 데이터 바인딩
3. PDF 파일 생성 (서버사이드 또는 클라이언트사이드)
4. 브라우저 다운로드 트리거

**예외 처리**

| 예외 상황 | 처리 방법 |
|----------|----------|
| PDF 생성 실패 | 에러 토스트 메시지 + 재시도 안내 |
| 네트워크 오류 | 에러 토스트 메시지 + 재시도 버튼 |

---

#### QT-03: 인쇄 기능

| 항목 | 내용 |
|------|------|
| 기능 ID | QT-03 |
| 기능명 | 인쇄 기능 |
| 우선순위 | P1 (Should Have) |

**사용자 스토리**
> As a 클라이언트,
> I want 견적서를 바로 인쇄하고 싶다,
> so that 빠르게 출력물을 얻을 수 있다.

**상세 설명**
- 브라우저 인쇄 기능을 활용한 견적서 인쇄
- 인쇄에 최적화된 스타일시트 적용

**인수 조건 (Acceptance Criteria)**
- [ ] 인쇄 버튼 클릭 시 브라우저 인쇄 다이얼로그 표시
- [ ] 인쇄 시 불필요한 UI 요소(헤더, 푸터, 버튼) 숨김
- [ ] A4 규격에 맞는 인쇄 레이아웃
- [ ] 컬러/흑백 인쇄 모두 가독성 확보

---

#### NT-01: 노션 데이터 동기화

| 항목 | 내용 |
|------|------|
| 기능 ID | NT-01 |
| 기능명 | 노션 데이터 동기화 |
| 우선순위 | P0 (Must Have) |

**사용자 스토리**
> As a 시스템,
> I want 노션 데이터베이스에서 견적서 정보를 가져오고 싶다,
> so that 최신 견적서 정보를 웹에서 표시할 수 있다.

**상세 설명**
- 노션 API (Official Integration)를 사용하여 데이터베이스 쿼리
- 특정 견적서 ID에 해당하는 페이지 정보 조회
- 페이지 내 블록 콘텐츠 조회

**인수 조건 (Acceptance Criteria)**
- [ ] 노션 API 연동 정상 작동
- [ ] 데이터베이스에서 견적서 정보 조회 가능
- [ ] 페이지 속성(Properties) 정상 파싱
- [ ] 데이터 캐싱으로 API 호출 최소화 (TTL: 5분)
- [ ] API Rate Limit 대응 (재시도 로직)

**비즈니스 로직**
1. 환경 변수에서 노션 API 키 및 데이터베이스 ID 로드
2. 노션 클라이언트 초기화
3. 데이터베이스 쿼리 또는 페이지 조회 실행
4. 응답 데이터를 애플리케이션 데이터 모델로 변환
5. 필요 시 캐시에 저장

---

#### UI-01: 반응형 레이아웃

| 항목 | 내용 |
|------|------|
| 기능 ID | UI-01 |
| 기능명 | 반응형 레이아웃 |
| 우선순위 | P0 (Must Have) |

**인수 조건 (Acceptance Criteria)**
- [ ] 모바일 (320px ~ 767px): 단일 컬럼 레이아웃
- [ ] 태블릿 (768px ~ 1023px): 적응형 레이아웃
- [ ] 데스크톱 (1024px ~): 최대 너비 제한 (1200px)
- [ ] 모든 브레이크포인트에서 가독성 확보
- [ ] 테이블 가로 스크롤 지원 (모바일)

---

#### UI-02: 다크모드 지원

| 항목 | 내용 |
|------|------|
| 기능 ID | UI-02 |
| 기능명 | 다크모드 지원 |
| 우선순위 | P1 (Should Have) |

**인수 조건 (Acceptance Criteria)**
- [ ] 시스템 설정 기반 자동 테마 적용
- [ ] 수동 테마 전환 토글 제공
- [ ] 다크모드에서 모든 텍스트 가독성 확보
- [ ] PDF 다운로드는 항상 라이트모드 스타일 적용

---

#### UI-03: 로딩 상태 표시

| 항목 | 내용 |
|------|------|
| 기능 ID | UI-03 |
| 기능명 | 로딩 상태 표시 |
| 우선순위 | P0 (Must Have) |

**인수 조건 (Acceptance Criteria)**
- [ ] 페이지 로딩 중 스켈레톤 UI 표시
- [ ] PDF 생성 중 로딩 인디케이터 및 진행 상태 표시
- [ ] 로딩 중 사용자 인터랙션 방지 (버튼 비활성화)

---

#### ER-01: 에러 페이지

| 항목 | 내용 |
|------|------|
| 기능 ID | ER-01 |
| 기능명 | 에러 페이지 |
| 우선순위 | P0 (Must Have) |

**인수 조건 (Acceptance Criteria)**
- [ ] 404 에러: "견적서를 찾을 수 없습니다" 메시지
- [ ] 500 에러: "일시적인 오류가 발생했습니다" 메시지 + 재시도 버튼
- [ ] 모든 에러 페이지에 홈으로 돌아가기 또는 문의하기 링크 제공

---

### 5.3 메뉴 구조

본 시스템은 클라이언트 전용 뷰어로, 별도의 네비게이션 메뉴 없이 단일 페이지 구조입니다.

| 페이지 | 경로 | 설명 | 구현 기능 ID |
|--------|------|------|--------------|
| 견적서 상세 | `/quote/[id]` | 견적서 내용 표시 | QT-01, QT-02, QT-03, UI-01, UI-02, UI-03 |
| 404 에러 | `/not-found` | 견적서 없음 | ER-01 |
| 500 에러 | `/error` | 서버 오류 | ER-01 |

---

## 6. 페이지별 상세 기능

### 6.1 견적서 상세 페이지 (`/quote/[id]`)

**구현 기능 ID**: QT-01, QT-02, QT-03, UI-01, UI-02, UI-03

#### 페이지 레이아웃

```
┌────────────────────────────────────────────────────────────┐
│  [로고]                              [다크모드 토글]        │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌──────────────────────────────────────────────────────┐  │
│  │                    견적서                             │  │
│  │                Quote #2024-001                       │  │
│  ├──────────────────────────────────────────────────────┤  │
│  │  발신                        │  수신                  │  │
│  │  ───────────────────────────┼───────────────────────│  │
│  │  회사명: ABC Company        │  회사명: XYZ Corp     │  │
│  │  담당자: 홍길동              │  담당자: 김철수        │  │
│  │  연락처: 02-1234-5678       │                        │  │
│  │  이메일: hong@abc.com       │                        │  │
│  ├──────────────────────────────────────────────────────┤  │
│  │  품목 내역                                           │  │
│  │  ┌──────┬────────────┬──────┬────────┬──────────┐   │  │
│  │  │ No.  │ 품명       │ 수량 │ 단가   │ 금액     │   │  │
│  │  ├──────┼────────────┼──────┼────────┼──────────┤   │  │
│  │  │ 1    │ 웹 개발    │ 1    │ 5,000  │ 5,000    │   │  │
│  │  │ 2    │ 디자인     │ 1    │ 2,000  │ 2,000    │   │  │
│  │  └──────┴────────────┴──────┴────────┴──────────┘   │  │
│  ├──────────────────────────────────────────────────────┤  │
│  │                              소계:     7,000,000원   │  │
│  │                              부가세:     700,000원   │  │
│  │                              ─────────────────────   │  │
│  │                              총액:     7,700,000원   │  │
│  ├──────────────────────────────────────────────────────┤  │
│  │  비고                                                │  │
│  │  - 견적 유효기간: 발행일로부터 30일                   │  │
│  │  - 결제조건: 계약금 50%, 잔금 50%                    │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                            │
│         [PDF 다운로드]    [인쇄하기]                        │
│                                                            │
├────────────────────────────────────────────────────────────┤
│  Copyright 2024 ABC Company. All rights reserved.         │
└────────────────────────────────────────────────────────────┘
```

#### UI 컴포넌트 구성

| 컴포넌트 | 설명 | ShadcnUI 컴포넌트 |
|----------|------|-------------------|
| 헤더 | 로고, 테마 토글 | - |
| 견적서 카드 | 견적서 전체 컨테이너 | Card |
| 정보 섹션 | 발신/수신자 정보 | Card, Separator |
| 품목 테이블 | 품목 리스트 | Table (custom) |
| 금액 요약 | 소계, 부가세, 총액 | - |
| 비고 섹션 | 추가 안내사항 | - |
| 액션 버튼 | PDF 다운로드, 인쇄 | Button |
| 푸터 | 저작권 정보 | - |

#### 상태 관리

| 상태 | 타입 | 초기값 | 설명 |
|------|------|--------|------|
| isLoading | boolean | true | 데이터 로딩 중 |
| quote | QuoteData \| null | null | 견적서 데이터 |
| error | Error \| null | null | 에러 정보 |
| isPdfGenerating | boolean | false | PDF 생성 중 |

---

### 6.2 에러 페이지

**구현 기능 ID**: ER-01

#### 404 에러 페이지 (`/not-found`)

```
┌────────────────────────────────────────────────────────────┐
│                                                            │
│                         404                                │
│                                                            │
│              견적서를 찾을 수 없습니다                       │
│                                                            │
│        요청하신 견적서가 존재하지 않거나                     │
│        삭제되었을 수 있습니다.                              │
│                                                            │
│                   [문의하기]                                │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

#### 500 에러 페이지 (`/error`)

```
┌────────────────────────────────────────────────────────────┐
│                                                            │
│                    오류가 발생했습니다                       │
│                                                            │
│          일시적인 문제가 발생했습니다.                       │
│          잠시 후 다시 시도해주세요.                         │
│                                                            │
│              [다시 시도]    [문의하기]                       │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

---

## 7. 비기능 요구사항 (Non-Functional Requirements)

### 7.1 성능 요구사항

| 항목 | 요구사항 | 측정 방법 |
|------|----------|----------|
| 페이지 로딩 시간 | 3초 이내 (LCP) | Lighthouse |
| PDF 생성 시간 | 5초 이내 | 실제 측정 |
| Time to Interactive | 3.5초 이내 | Lighthouse |
| API 응답 시간 | 2초 이내 | 서버 로그 |

### 7.2 보안 요구사항

| 항목 | 요구사항 |
|------|----------|
| URL 보안 | UUID v4 기반 고유 식별자 사용 (예측 불가능) |
| API 키 보호 | 환경 변수로 관리, 클라이언트 노출 금지 |
| HTTPS | 모든 통신 HTTPS 필수 |
| Rate Limiting | IP당 분당 60회 요청 제한 |
| XSS 방지 | 사용자 입력 데이터 이스케이프 처리 |

### 7.3 확장성 요구사항

| 항목 | 요구사항 |
|------|----------|
| 동시 접속자 | 100명 이상 동시 접속 지원 |
| 데이터 캐싱 | 노션 API 응답 캐싱 (TTL 5분) |
| CDN | 정적 자산 CDN 배포 |

### 7.4 접근성 요구사항

| 항목 | 요구사항 |
|------|----------|
| WCAG 준수 | WCAG 2.1 AA 수준 |
| 키보드 네비게이션 | 모든 기능 키보드로 접근 가능 |
| 스크린 리더 | 주요 콘텐츠 aria-label 제공 |
| 색상 대비 | 최소 4.5:1 대비율 |

### 7.5 호환성 요구사항

| 브라우저 | 최소 버전 |
|----------|----------|
| Chrome | 90+ |
| Safari | 14+ |
| Firefox | 90+ |
| Edge | 90+ |
| Mobile Safari | iOS 14+ |
| Chrome Mobile | Android 10+ |

---

## 8. 기술 요구사항 (Technical Requirements)

### 8.1 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         클라이언트                               │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                    Next.js App                            │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │  │
│  │  │   Pages     │  │ Components  │  │   Hooks     │       │  │
│  │  │  /quote/[id]│  │  QuoteCard  │  │ useQuote    │       │  │
│  │  │             │  │  PdfButton  │  │ usePdf      │       │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘       │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         서버 (Next.js API Routes)               │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  /api/quote/[id]          │  /api/quote/[id]/pdf          │  │
│  │  - 견적서 데이터 조회      │  - PDF 생성 및 반환            │  │
│  └───────────────────────────────────────────────────────────┘  │
│                              │                                  │
│                              ▼                                  │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                    Notion Client                          │  │
│  │  - @notionhq/client                                       │  │
│  │  - Database Query                                         │  │
│  │  - Page Retrieve                                          │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         Notion                                  │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                  견적서 데이터베이스                        │  │
│  │  - 견적 번호, 발행일, 유효기간                             │  │
│  │  - 발신자/수신자 정보                                      │  │
│  │  - 품목 테이블                                             │  │
│  │  - 금액 정보                                               │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

### 8.2 기술 스택

| 카테고리 | 기술 | 버전 | 용도 |
|----------|------|------|------|
| Framework | Next.js | 16.x | 풀스택 프레임워크 |
| Runtime | React | 19.x | UI 라이브러리 |
| Language | TypeScript | 5.x | 타입 안전성 |
| Styling | TailwindCSS | 4.x | 유틸리티 CSS |
| UI Components | ShadcnUI | latest | 컴포넌트 라이브러리 |
| Animation | Framer Motion | 12.x | 애니메이션 |
| Form | React Hook Form + Zod | latest | 폼 처리 (향후 확장용) |
| Theme | next-themes | 0.4.x | 다크모드 |
| Toast | Sonner | 2.x | 알림 메시지 |
| Notion API | @notionhq/client | latest | 노션 연동 |
| PDF | @react-pdf/renderer 또는 puppeteer | latest | PDF 생성 |
| Date | date-fns | 4.x | 날짜 처리 |

### 8.3 디렉토리 구조 (신규 추가분)

```
src/
├── app/
│   ├── (main)/
│   │   └── quote/
│   │       └── [id]/
│   │           ├── page.tsx           # 견적서 상세 페이지
│   │           └── loading.tsx        # 로딩 UI
│   └── api/
│       └── quote/
│           └── [id]/
│               ├── route.ts           # 견적서 데이터 API
│               └── pdf/
│                   └── route.ts       # PDF 생성 API
├── components/
│   ├── quote/
│   │   ├── QuoteHeader.tsx           # 견적서 헤더
│   │   ├── QuoteInfo.tsx             # 발신/수신자 정보
│   │   ├── QuoteItemsTable.tsx       # 품목 테이블
│   │   ├── QuoteSummary.tsx          # 금액 요약
│   │   ├── QuoteNotes.tsx            # 비고 섹션
│   │   ├── QuoteActions.tsx          # 액션 버튼 (PDF, 인쇄)
│   │   └── QuoteSkeleton.tsx         # 스켈레톤 로딩
│   └── pdf/
│       └── QuotePdfTemplate.tsx      # PDF 템플릿
├── lib/
│   ├── notion/
│   │   ├── client.ts                 # 노션 클라이언트
│   │   ├── queries.ts                # 노션 쿼리 함수
│   │   └── transformers.ts           # 데이터 변환 함수
│   └── pdf/
│       └── generator.ts              # PDF 생성 로직
├── types/
│   └── quote.ts                      # 견적서 관련 타입
└── hooks/
    ├── useQuote.ts                   # 견적서 데이터 훅
    └── usePdfDownload.ts             # PDF 다운로드 훅
```

### 8.4 API 명세

#### GET /api/quote/[id]

**설명**: 특정 견적서 데이터 조회

**요청**
```
GET /api/quote/{quoteId}
```

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| quoteId | string | Y | 견적서 고유 식별자 |

**응답 (성공: 200)**
```json
{
  "success": true,
  "data": {
    "id": "uuid-string",
    "quoteNumber": "2024-001",
    "issueDate": "2024-01-15",
    "validUntil": "2024-02-14",
    "status": "active",
    "sender": {
      "companyName": "ABC Company",
      "contactName": "홍길동",
      "phone": "02-1234-5678",
      "email": "hong@abc.com",
      "address": "서울시 강남구"
    },
    "receiver": {
      "companyName": "XYZ Corporation",
      "contactName": "김철수"
    },
    "items": [
      {
        "id": 1,
        "name": "웹 개발",
        "description": "반응형 웹사이트 개발",
        "quantity": 1,
        "unit": "식",
        "unitPrice": 5000000,
        "amount": 5000000
      }
    ],
    "subtotal": 7000000,
    "tax": 700000,
    "total": 7700000,
    "notes": "견적 유효기간: 발행일로부터 30일"
  }
}
```

**응답 (실패: 404)**
```json
{
  "success": false,
  "error": {
    "code": "QUOTE_NOT_FOUND",
    "message": "견적서를 찾을 수 없습니다."
  }
}
```

**응답 (실패: 500)**
```json
{
  "success": false,
  "error": {
    "code": "INTERNAL_ERROR",
    "message": "서버 오류가 발생했습니다."
  }
}
```

---

#### GET /api/quote/[id]/pdf

**설명**: 견적서 PDF 파일 생성 및 다운로드

**요청**
```
GET /api/quote/{quoteId}/pdf
```

**응답 (성공: 200)**
- Content-Type: `application/pdf`
- Content-Disposition: `attachment; filename="견적서_2024-001_20240115.pdf"`
- Body: PDF 파일 바이너리

**응답 (실패: 404/500)**
- JSON 에러 응답 (위와 동일)

---

### 8.5 데이터 모델

#### 노션 데이터베이스 스키마

| 속성명 | 노션 타입 | 필수 | 설명 |
|--------|----------|------|------|
| 견적번호 | Title | Y | 견적서 고유 번호 |
| 발행일 | Date | Y | 견적서 발행 날짜 |
| 유효기간 | Date | Y | 견적서 유효 만료일 |
| 상태 | Select | Y | active, expired, cancelled |
| 발신회사 | Text | Y | 발신자 회사명 |
| 발신담당자 | Text | Y | 발신자 담당자명 |
| 발신연락처 | Phone | N | 발신자 전화번호 |
| 발신이메일 | Email | N | 발신자 이메일 |
| 발신주소 | Text | N | 발신자 주소 |
| 수신회사 | Text | Y | 수신자 회사명 |
| 수신담당자 | Text | N | 수신자 담당자명 |
| 소계 | Number | Y | 품목 합계 (세전) |
| 부가세 | Number | Y | 부가가치세 |
| 총액 | Number | Y | 최종 합계 |
| 비고 | Text | N | 추가 안내사항 |
| 품목 | Relation | Y | 품목 데이터베이스 연결 |

#### 품목 데이터베이스 스키마

| 속성명 | 노션 타입 | 필수 | 설명 |
|--------|----------|------|------|
| 품명 | Title | Y | 품목 이름 |
| 설명 | Text | N | 품목 상세 설명 |
| 수량 | Number | Y | 수량 |
| 단위 | Select | Y | 개, 식, EA 등 |
| 단가 | Number | Y | 개당 가격 |
| 금액 | Formula | Y | 수량 x 단가 |
| 견적서 | Relation | Y | 견적서 데이터베이스 연결 |

#### TypeScript 타입 정의

```typescript
// src/types/quote.ts

export interface QuoteData {
  id: string;
  quoteNumber: string;
  issueDate: string;
  validUntil: string;
  status: QuoteStatus;
  sender: SenderInfo;
  receiver: ReceiverInfo;
  items: QuoteItem[];
  subtotal: number;
  tax: number;
  total: number;
  notes: string | null;
}

export type QuoteStatus = 'active' | 'expired' | 'cancelled';

export interface SenderInfo {
  companyName: string;
  contactName: string;
  phone: string | null;
  email: string | null;
  address: string | null;
}

export interface ReceiverInfo {
  companyName: string;
  contactName: string | null;
}

export interface QuoteItem {
  id: number;
  name: string;
  description: string | null;
  quantity: number;
  unit: string;
  unitPrice: number;
  amount: number;
}

export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: ApiError;
}

export interface ApiError {
  code: string;
  message: string;
}
```

---

## 9. UI/UX 요구사항

### 9.1 디자인 원칙

| 원칙 | 설명 |
|------|------|
| 명확성 | 견적서 정보가 한눈에 파악되도록 구조화 |
| 전문성 | 비즈니스 문서에 적합한 깔끔한 디자인 |
| 일관성 | 웹 뷰와 PDF 출력물의 디자인 일관성 유지 |
| 접근성 | 모든 사용자가 쉽게 접근 가능한 UI |

### 9.2 컬러 팔레트

| 용도 | Light Mode | Dark Mode |
|------|------------|-----------|
| 배경 | #FFFFFF | #0A0A0A |
| 카드 배경 | #FFFFFF | #171717 |
| 주요 텍스트 | #0A0A0A | #FAFAFA |
| 보조 텍스트 | #737373 | #A3A3A3 |
| 테두리 | #E5E5E5 | #262626 |
| 강조색 (Primary) | #2563EB | #3B82F6 |
| 성공 | #16A34A | #22C55E |
| 경고 | #EAB308 | #FACC15 |
| 에러 | #DC2626 | #EF4444 |

### 9.3 타이포그래피

| 용도 | 폰트 | 크기 | 굵기 |
|------|------|------|------|
| 견적서 제목 | Space Grotesk | 24px / 1.5rem | 700 |
| 견적 번호 | Space Grotesk | 18px / 1.125rem | 600 |
| 섹션 제목 | Noto Sans KR | 16px / 1rem | 600 |
| 본문 | Noto Sans KR | 14px / 0.875rem | 400 |
| 테이블 헤더 | Noto Sans KR | 14px / 0.875rem | 600 |
| 금액 (강조) | Space Grotesk | 18px / 1.125rem | 700 |
| 캡션 | Noto Sans KR | 12px / 0.75rem | 400 |

### 9.4 컴포넌트 스타일 가이드

#### 버튼

| 타입 | 용도 | 스타일 |
|------|------|--------|
| Primary | PDF 다운로드 | 파란색 배경, 흰색 텍스트 |
| Secondary | 인쇄하기 | 투명 배경, 테두리 |
| Ghost | 테마 토글 | 투명 배경, 호버 시 배경색 |

#### 카드

- 둥근 모서리: `rounded-lg` (8px)
- 그림자: `shadow-sm` (Light) / `shadow-none` (Dark)
- 패딩: `p-6` (24px)

#### 테이블

- 헤더 배경: 연한 회색 (`bg-muted`)
- 행 구분: 하단 테두리 (`border-b`)
- 셀 패딩: `px-4 py-3`
- 숫자 정렬: 우측 정렬

### 9.5 애니메이션

| 요소 | 애니메이션 | 설정 |
|------|------------|------|
| 페이지 진입 | FadeIn | duration: 0.3s |
| 카드 진입 | SlideIn (from bottom) | duration: 0.4s, delay: 0.1s |
| 버튼 호버 | Scale | scale: 1.02 |
| 로딩 스켈레톤 | Pulse | duration: 1.5s, infinite |
| 토스트 알림 | SlideIn (from right) | duration: 0.3s |

### 9.6 반응형 브레이크포인트

| 브레이크포인트 | 너비 | 레이아웃 변경 |
|---------------|------|---------------|
| Mobile | < 640px | 단일 컬럼, 테이블 가로 스크롤 |
| Tablet | 640px ~ 1023px | 발신/수신 정보 2컬럼 |
| Desktop | >= 1024px | 최대 너비 제한 (1200px), 중앙 정렬 |

---

## 10. 보안 요구사항

### 10.1 인증 및 권한

| 항목 | 구현 방법 |
|------|----------|
| 견적서 접근 | UUID v4 기반 고유 URL (예: `/quote/550e8400-e29b-41d4-a716-446655440000`) |
| URL 추측 방지 | 충분한 엔트로피의 UUID 사용 (2^122 경우의 수) |
| API 키 보호 | 서버 사이드에서만 사용, 환경 변수로 관리 |

### 10.2 데이터 보호

| 항목 | 구현 방법 |
|------|----------|
| 전송 암호화 | HTTPS 필수 (TLS 1.2+) |
| 민감 정보 | 클라이언트 측에 API 키, 데이터베이스 ID 노출 금지 |
| 로깅 | 견적서 ID만 로깅, 상세 내용 로깅 금지 |

### 10.3 입력 검증

| 항목 | 검증 방법 |
|------|----------|
| URL 파라미터 | UUID 형식 검증 |
| API 응답 | Zod 스키마로 타입 검증 |
| XSS 방지 | React의 자동 이스케이프 + 추가 검증 |

### 10.4 Rate Limiting

| 엔드포인트 | 제한 |
|------------|------|
| /api/quote/[id] | IP당 60회/분 |
| /api/quote/[id]/pdf | IP당 10회/분 |

---

## 11. 리스크 및 가정 (Risks & Assumptions)

### 11.1 리스크

| 리스크 | 영향도 | 발생 가능성 | 완화 방안 |
|--------|--------|-------------|----------|
| 노션 API 장애 | 높음 | 낮음 | 에러 처리 UI, 재시도 로직, 캐싱 |
| 노션 API Rate Limit | 중간 | 중간 | 캐싱 (TTL 5분), 지수 백오프 재시도 |
| PDF 생성 성능 이슈 | 중간 | 중간 | 서버사이드 생성, 비동기 처리 |
| 한글 폰트 PDF 렌더링 | 중간 | 낮음 | 폰트 임베딩, 사전 테스트 |
| URL 유출로 인한 견적서 노출 | 높음 | 낮음 | UUID 사용, 유효기간 설정 |

### 11.2 가정사항

| 가정 | 검증 방법 |
|------|----------|
| 클라이언트는 최신 브라우저 사용 | 호환성 목록 안내 |
| 노션 데이터베이스 구조가 정해진 스키마를 따름 | 문서화 및 검증 로직 |
| 동시 접속자 100명 이하 | 모니터링 후 필요 시 확장 |
| PDF 다운로드 빈도가 페이지 조회의 30% 이하 | 사용 통계 모니터링 |

### 11.3 의존성

| 의존성 | 유형 | 비고 |
|--------|------|------|
| Notion API | 외부 서비스 | 가용성 99.9% SLA |
| Vercel (배포 시) | 인프라 | 가용성 99.99% SLA |
| @react-pdf/renderer | 라이브러리 | 버전 호환성 확인 필요 |

---

## 12. 성공 지표 (Success Metrics)

### 12.1 핵심 성과 지표 (KPIs)

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| 페이지 로드 성공률 | 99.5% 이상 | 에러 로깅 |
| 평균 페이지 로드 시간 | 3초 이내 | 성능 모니터링 |
| PDF 다운로드 성공률 | 99% 이상 | 다운로드 완료 추적 |
| 사용자 문의 건수 | 월 5건 이하 | 고객 지원 티켓 |

### 12.2 품질 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| Lighthouse Performance | 90점 이상 | Lighthouse CI |
| Lighthouse Accessibility | 90점 이상 | Lighthouse CI |
| Core Web Vitals | Good | Google Search Console |
| 테스트 커버리지 | 80% 이상 | Jest Coverage |

---

## 13. 개발 단계 및 마일스톤

### 13.1 개발 일정

| 단계 | 기간 | 산출물 |
|------|------|--------|
| Phase 1: 설계 | 1주 | PRD 완료, 기술 설계서 |
| Phase 2: 기반 구축 | 1주 | 노션 API 연동, 기본 라우팅 |
| Phase 3: UI 개발 | 2주 | 견적서 뷰어 페이지 완성 |
| Phase 4: PDF 기능 | 1주 | PDF 생성 및 다운로드 |
| Phase 5: 테스트 및 QA | 1주 | 버그 수정, 성능 최적화 |
| Phase 6: 배포 | 0.5주 | 프로덕션 배포 |

**총 예상 기간: 6.5주**

### 13.2 마일스톤 상세

#### Phase 1: 설계 (1주)
- [x] PRD 작성 완료
- [ ] 기술 설계서 작성
- [ ] 노션 데이터베이스 스키마 확정
- [ ] UI/UX 와이어프레임 검토

#### Phase 2: 기반 구축 (1주)
- [ ] 노션 API 연동 (`@notionhq/client` 설정)
- [ ] 환경 변수 설정 (`.env`)
- [ ] API 라우트 기본 구조 생성
- [ ] 타입 정의 (`src/types/quote.ts`)
- [ ] 노션 데이터 변환 유틸리티

#### Phase 3: UI 개발 (2주)
**Week 1:**
- [ ] 견적서 상세 페이지 레이아웃
- [ ] QuoteHeader 컴포넌트
- [ ] QuoteInfo 컴포넌트 (발신/수신자)
- [ ] QuoteItemsTable 컴포넌트

**Week 2:**
- [ ] QuoteSummary 컴포넌트 (금액)
- [ ] QuoteNotes 컴포넌트
- [ ] QuoteActions 컴포넌트
- [ ] 스켈레톤 로딩 UI
- [ ] 에러 페이지 (404, 500)
- [ ] 반응형 스타일링
- [ ] 다크모드 지원

#### Phase 4: PDF 기능 (1주)
- [ ] PDF 라이브러리 선정 및 설정
- [ ] PDF 템플릿 디자인
- [ ] PDF 생성 API 구현
- [ ] 다운로드 기능 연동
- [ ] 인쇄 기능 구현

#### Phase 5: 테스트 및 QA (1주)
- [ ] 단위 테스트 작성
- [ ] 통합 테스트 작성
- [ ] 크로스 브라우저 테스트
- [ ] 모바일 테스트
- [ ] 성능 최적화 (Lighthouse)
- [ ] 접근성 검증

#### Phase 6: 배포 (0.5주)
- [ ] 프로덕션 환경 설정
- [ ] CI/CD 파이프라인 구성
- [ ] 도메인 연결
- [ ] SSL 인증서 설정
- [ ] 모니터링 설정

---

## 14. 정합성 검증 결과

### 14.1 기능 명세 → 페이지 연결 검증

| 기능 ID | 기능명 | 관련 페이지 | 페이지 존재 여부 |
|---------|--------|-------------|-----------------|
| QT-01 | 견적서 상세 조회 | 견적서 상세 페이지 | O |
| QT-02 | PDF 다운로드 | 견적서 상세 페이지 | O |
| QT-03 | 인쇄 기능 | 견적서 상세 페이지 | O |
| NT-01 | 노션 데이터 동기화 | (백엔드) | O (API) |
| NT-02 | 실시간 데이터 갱신 | 견적서 상세 페이지 | O |
| UI-01 | 반응형 레이아웃 | 전체 | O |
| UI-02 | 다크모드 지원 | 전체 | O |
| UI-03 | 로딩 상태 표시 | 전체 | O |
| ER-01 | 에러 페이지 | 404/500 에러 페이지 | O |

### 14.2 메뉴 구조 → 페이지 연결 검증

| 페이지 | 경로 | 구현 기능 ID | 기능 정의 여부 |
|--------|------|--------------|---------------|
| 견적서 상세 | `/quote/[id]` | QT-01, QT-02, QT-03, UI-01, UI-02, UI-03 | O |
| 404 에러 | `/not-found` | ER-01 | O |
| 500 에러 | `/error` | ER-01 | O |

### 14.3 검증 결과 요약

- [x] 모든 기능 ID가 페이지별 상세 기능에 매핑됨
- [x] 모든 페이지가 메뉴 구조에서 접근 가능
- [x] 고아 기능 없음 (페이지 없이 정의된 기능)
- [x] 고아 페이지 없음 (기능 없이 정의된 페이지)

---

## 15. 부록 (Appendix)

### 15.1 용어 정의

| 용어 | 정의 |
|------|------|
| 견적서 (Quote) | 상품이나 서비스의 가격과 조건을 제시하는 문서 |
| 노션 (Notion) | 협업 및 문서 관리 도구 |
| 노션 API | 노션 데이터에 프로그래밍 방식으로 접근하기 위한 인터페이스 |
| UUID | Universally Unique Identifier, 고유 식별자 |
| TTL | Time To Live, 캐시 유효 기간 |
| LCP | Largest Contentful Paint, 웹 성능 지표 |

### 15.2 참고 자료

- [Notion API 공식 문서](https://developers.notion.com/)
- [Next.js 공식 문서](https://nextjs.org/docs)
- [ShadcnUI 공식 문서](https://ui.shadcn.com/)
- [React-PDF 공식 문서](https://react-pdf.org/)

### 15.3 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0.0 | 2026-01-17 | Product Team | 최초 작성 |

---

## 16. 승인

| 역할 | 이름 | 서명 | 날짜 |
|------|------|------|------|
| Product Manager | | | |
| Tech Lead | | | |
| Designer | | | |
| Stakeholder | | | |
